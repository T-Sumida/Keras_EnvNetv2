# Keras_EnvNetv2
EnvNetv2 for tf.keras

# Overview
EnvNetV2's keras implementation.

# Environment
- python 3.7.0

```
$ git clone https://github.com/T-Sumida/Keras_EnvNetv2.git
$ cd Keras_EnvNetV2
$ pip install -r requirements.txt
```

# Usage
main.py is prepared as a sample program.

```
$ python main.py
Model: "model"
_________________________________________________________________
Layer (type)                 Output Shape              Param #
=================================================================
sound_input (InputLayer)     [(None, 44100, 1, 1)]     0
_________________________________________________________________
conv2d (Conv2D)              (None, 22019, 1, 32)      2048
_________________________________________________________________
batch_normalization (BatchNo (None, 22019, 1, 32)      128
_________________________________________________________________
activation (Activation)      (None, 22019, 1, 32)      0
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 11002, 1, 64)      32768
_________________________________________________________________
batch_normalization_1 (Batch (None, 11002, 1, 64)      256
_________________________________________________________________
activation_1 (Activation)    (None, 11002, 1, 64)      0
_________________________________________________________________
max_pooling2d (MaxPooling2D) (None, 171, 1, 64)        0
_________________________________________________________________
permute (Permute)            (None, 171, 64, 1)        0
_________________________________________________________________
conv2d_2 (Conv2D)            (None, 164, 57, 32)       2048
_________________________________________________________________
batch_normalization_2 (Batch (None, 164, 57, 32)       128
_________________________________________________________________
activation_2 (Activation)    (None, 164, 57, 32)       0
_________________________________________________________________
conv2d_3 (Conv2D)            (None, 157, 50, 32)       65536
_________________________________________________________________
batch_normalization_3 (Batch (None, 157, 50, 32)       128
_________________________________________________________________
activation_3 (Activation)    (None, 157, 50, 32)       0
_________________________________________________________________
max_pooling2d_1 (MaxPooling2 (None, 52, 10, 32)        0
_________________________________________________________________
conv2d_4 (Conv2D)            (None, 49, 10, 64)        8192
_________________________________________________________________
batch_normalization_4 (Batch (None, 49, 10, 64)        256
_________________________________________________________________
activation_4 (Activation)    (None, 49, 10, 64)        0
_________________________________________________________________
conv2d_5 (Conv2D)            (None, 46, 10, 64)        16384
_________________________________________________________________
batch_normalization_5 (Batch (None, 46, 10, 64)        256
_________________________________________________________________
activation_5 (Activation)    (None, 46, 10, 64)        0
_________________________________________________________________
max_pooling2d_2 (MaxPooling2 (None, 23, 10, 64)        0
_________________________________________________________________
conv2d_6 (Conv2D)            (None, 22, 10, 128)       16384
_________________________________________________________________
batch_normalization_6 (Batch (None, 22, 10, 128)       512
_________________________________________________________________
activation_6 (Activation)    (None, 22, 10, 128)       0
_________________________________________________________________
conv2d_7 (Conv2D)            (None, 21, 10, 128)       32768
_________________________________________________________________
batch_normalization_7 (Batch (None, 21, 10, 128)       512
_________________________________________________________________
activation_7 (Activation)    (None, 21, 10, 128)       0
_________________________________________________________________
max_pooling2d_3 (MaxPooling2 (None, 10, 10, 128)       0
_________________________________________________________________
conv2d_8 (Conv2D)            (None, 9, 10, 256)        65536
_________________________________________________________________
batch_normalization_8 (Batch (None, 9, 10, 256)        1024
_________________________________________________________________
activation_8 (Activation)    (None, 9, 10, 256)        0
_________________________________________________________________
conv2d_9 (Conv2D)            (None, 8, 10, 256)        131072
_________________________________________________________________
batch_normalization_9 (Batch (None, 8, 10, 256)        1024
_________________________________________________________________
activation_9 (Activation)    (None, 8, 10, 256)        0
_________________________________________________________________
max_pooling2d_4 (MaxPooling2 (None, 4, 10, 256)        0
_________________________________________________________________
flatten (Flatten)            (None, 10240)             0
_________________________________________________________________
dense (Dense)                (None, 4096)              41947136
_________________________________________________________________
dropout (Dropout)            (None, 4096)              0
_________________________________________________________________
dense_1 (Dense)              (None, 4096)              16781312
_________________________________________________________________
dropout_1 (Dropout)          (None, 4096)              0
_________________________________________________________________
dense_2 (Dense)              (None, 5)                 20485
=================================================================
Total params: 59,125,893
Trainable params: 59,123,781
Non-trainable params: 2,112
_________________________________________________________________
None
Epoch 1/10
20/20 [==============================] - 22s 1s/sample - loss: 30.6047
Epoch 2/10
20/20 [==============================] - 11s 535ms/sample - loss: 69.5936
Epoch 3/10
20/20 [==============================] - 9s 450ms/sample - loss: 62.6598
Epoch 4/10
20/20 [==============================] - 9s 437ms/sample - loss: 67.0129
Epoch 5/10
20/20 [==============================] - 9s 443ms/sample - loss: 26.4513
Epoch 6/10
20/20 [==============================] - 8s 384ms/sample - loss: 33.6918
Epoch 7/10
20/20 [==============================] - 8s 417ms/sample - loss: 27.7485
Epoch 8/10
20/20 [==============================] - 8s 411ms/sample - loss: 12.0867
Epoch 9/10
20/20 [==============================] - 9s 441ms/sample - loss: 2.4412
Epoch 10/10
20/20 [==============================] - 8s 407ms/sample - loss: 3.3585
```


# License
Copyright Â© 2020 T_Sumida Distributed under the MIT License.
